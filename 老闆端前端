<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸª åº—å®¶å¾Œå°ç®¡ç†èˆ‡è¨‚å–®ç³»çµ±</title>
  <style>
    body { font-family: "Microsoft JhengHei", sans-serif; margin: 0; background:#f7f7f7; }
    header { background:#43a047; color:#fff; text-align:center; padding:15px; font-size:22px; font-weight:bold; }
    .container { max-width:900px; margin:20px auto; background:#fff; border-radius:10px; padding:20px; box-shadow:0 0 8px rgba(0,0,0,.1); }
    button { cursor:pointer; border:none; border-radius:6px; padding:6px 12px; font-weight:bold; }
    .open-btn{background:#4caf50;color:#fff;}
    .close-btn{background:#e53935;color:#fff;}
    .danger{background:#e53935;color:#fff;}
    .primary{background:#43a047;color:#fff;}
    .status{font-size:18px;font-weight:bold;margin-top:10px;text-align:center;}
    .status.open{color:#43a047;}
    .status.closed{color:#e53935;}
    input{padding:6px;border-radius:5px;border:1px solid #ccc;margin:3px 0;}
    table{width:100%;border-collapse:collapse;margin-top:10px;}
    th,td{padding:8px;border-bottom:1px solid #ccc;text-align:center;}
    th{background:#e8f5e9;}
    .tab-buttons{display:flex;justify-content:center;margin-bottom:15px;}
    .tab-buttons button.active{background:#43a047;color:#fff;}
    .page{display:none;}
    .page.active{display:block;}
    .order-actions{margin-top:10px;text-align:right;}
  </style>
</head>
<body>

<header>ğŸª åº—å®¶å¾Œå°ç®¡ç†èˆ‡è¨‚å–®ç³»çµ±</header>

<div class="container">
  <div class="tab-buttons">
    <button id="tab1" class="active">åº—å®¶è³‡è¨Š</button>
    <button id="tab2">èœå–®ç®¡ç†</button>
    <button id="tab3">è¨‚å–®ç®¡ç†</button>
  </div>

  <!-- åº—å®¶è³‡è¨Š -->
  <div id="page1" class="page active">
    <input id="ownerName" placeholder="è€é—†å§“å">
    <input id="shopName" placeholder="åº—å">
    <button id="saveShopBtn">å„²å­˜</button>
    <p id="shopDisplay">å°šæœªè¨­å®š</p>
    <button id="openBtn" class="open-btn">é–‹å§‹ç‡Ÿæ¥­</button>
    <button id="closeBtn" class="close-btn">çµæŸç‡Ÿæ¥­</button>
    <div id="statusText" class="status closed">ç›®å‰ç‹€æ…‹ï¼šä¼‘æ¥­ä¸­</div>
  </div>

  <!-- èœå–®ç®¡ç† -->
  <div id="page2" class="page">
    <input id="itemName" placeholder="å“é …">
    <input id="itemPrice" type="number" placeholder="åƒ¹æ ¼">
    <input id="itemStock" type="number" placeholder="åº«å­˜">
    <button id="addItemBtn">æ–°å¢èœå–®</button>

    <table>
      <thead>
        <tr><th>å“é …</th><th>åƒ¹æ ¼</th><th>åº«å­˜</th><th>æ“ä½œ</th></tr>
      </thead>
      <tbody id="menuTable"></tbody>
    </table>
  </div>

  <!-- è¨‚å–®ç®¡ç† -->
  <div id="page3" class="page">
    <table>
      <thead>
        <tr><th>å“é …</th><th>æ•¸é‡</th><th>ç¸½åƒ¹</th><th>æ“ä½œ</th></tr>
      </thead>
      <tbody id="orderTable"></tbody>
    </table>

    <div class="order-actions">
      <button class="primary" onclick="submitOrders()">é€å‡ºè¨‚å–®</button>
    </div>
  </div>
</div>

<script>
/* ========= å·¥å…· ========= */
const $ = id => document.getElementById(id);

/* ========= Tab ========= */
document.querySelectorAll(".tab-buttons button").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll(".tab-buttons button").forEach(b=>b.classList.remove("active"));
    document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
    btn.classList.add("active");
    $(btn.id.replace("tab","page")).classList.add("active");
  };
});

/* ========= åº—å®¶ ========= */
$("saveShopBtn").onclick=()=>{
  $("shopDisplay").textContent = $("ownerName").value+"ï½œ"+$("shopName").value;
};
$("openBtn").onclick=()=>{ $("statusText").textContent="ç›®å‰ç‹€æ…‹ï¼šç‡Ÿæ¥­ä¸­"; $("statusText").className="status open"; };
$("closeBtn").onclick=()=>{ $("statusText").textContent="ç›®å‰ç‹€æ…‹ï¼šä¼‘æ¥­ä¸­"; $("statusText").className="status closed"; };

/* ========= è³‡æ–™ ========= */
let menu = JSON.parse(localStorage.getItem("menu")||"[]");
let orders = JSON.parse(localStorage.getItem("orders")||"[]");

function saveData(){
  localStorage.setItem("menu",JSON.stringify(menu));
  localStorage.setItem("orders",JSON.stringify(orders));
}

/* ========= èœå–® ========= */
function renderMenu(){
  $("menuTable").innerHTML="";
  menu.forEach((m,i)=>{
    $("menuTable").innerHTML+=`
      <tr>
        <td>${m.name}</td>
        <td>$${m.price}</td>
        <td>${m.stock}</td>
        <td>
          <button onclick="orderItem(${i})">ä¸‹å–®</button>
          <button class="danger" onclick="delItem(${i})">åˆªé™¤</button>
        </td>
      </tr>`;
  });
}

$("addItemBtn").onclick=()=>{
  if(!$("itemName").value) return;
  menu.push({
    name:$("itemName").value,
    price:+$("itemPrice").value,
    stock:+$("itemStock").value
  });
  saveData(); renderMenu();
};

/* ========= è¨‚å–® ========= */
function orderItem(i){
  if(menu[i].stock<=0){ alert("åº«å­˜ä¸è¶³"); return; }
  menu[i].stock--;
  orders.push({
    name:menu[i].name,
    qty:1,
    total:menu[i].price
  });
  saveData(); renderMenu(); renderOrders();
}

function renderOrders(){
  $("orderTable").innerHTML="";
  orders.forEach((o,i)=>{
    $("orderTable").innerHTML+=`
      <tr>
        <td>${o.name}</td>
        <td>${o.qty}</td>
        <td>$${o.total}</td>
        <td>
          <button class="danger" onclick="delOrder(${i})">åˆªé™¤</button>
        </td>
      </tr>`;
  });
}

function delOrder(i){
  orders.splice(i,1);
  saveData(); renderOrders();
}

function submitOrders(){
  if(orders.length===0){
    alert("ç›®å‰æ²’æœ‰è¨‚å–®");
    return;
  }
  if(!confirm("ç¢ºå®šé€å‡ºæ‰€æœ‰è¨‚å–®ï¼Ÿ")) return;

  orders = [];
  saveData();
  renderOrders();
  alert("è¨‚å–®å·²é€å‡ºï¼");
}

/* ========= åˆªé™¤èœå–® ========= */
function delItem(i){
  menu.splice(i,1);
  saveData(); renderMenu();
}

renderMenu(); renderOrders();
</script>

</body>
</html>
